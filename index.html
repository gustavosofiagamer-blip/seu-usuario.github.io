<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Pega-Pega das Bolas</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #111;
}
canvas { display: block; }
</style>
</head>
<body>
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const RAIO = 14;
const TEMPO_FUGA = 10 * 60; // 10 segundos
const cores = [
  {nome:"AMARELO", cor:"yellow"},
  {nome:"VERMELHO", cor:"red"},
  {nome:"AZUL", cor:"dodgerblue"},
  {nome:"VERDE", cor:"lime"}
];

let pegadora, fugitiva;
let tempo, estado;
let confetes = [];
let roleta1 = 0, roleta2 = 0;
let tempoRoleta = 120;
let cor1, cor2;

// ===== IN√çCIO =====
iniciarRoletas();

function iniciarRoletas() {
  estado = "roleta";
  tempoRoleta = 120;
}

function iniciarJogo() {
  pegadora = criarBola(cor1.cor);
  fugitiva = criarBola(cor2.cor);
  tempo = TEMPO_FUGA;
  confetes = [];
  estado = "jogando";
}

function criarBola(cor) {
  return {
    cor,
    x: Math.random() * (canvas.width - RAIO*2) + RAIO,
    y: Math.random() * (canvas.height - RAIO*2) + RAIO,
    vx: 0,
    vy: 0
  };
}

function criarConfetes(cor) {
  for (let i = 0; i < 120; i++) {
    confetes.push({
      x: canvas.width/2,
      y: canvas.height/2,
      dx: (Math.random()-0.5)*10,
      dy: (Math.random()-0.5)*10,
      vida: 90,
      cor
    });
  }
}

// ===== LOOP =====
function loop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ===== ROLETAS =====
  if (estado === "roleta") {
    roleta1 = Math.floor(Math.random() * cores.length);
    do {
      roleta2 = Math.floor(Math.random() * cores.length);
    } while (roleta2 === roleta1);

    ctx.textAlign = "center";
    ctx.textBaseline = "middle";

    ctx.font = "bold 80px Arial";
    ctx.fillStyle = cores[roleta1].cor;
    ctx.fillText(cores[roleta1].nome, canvas.width*0.3, canvas.height/2);

    ctx.fillStyle = cores[roleta2].cor;
    ctx.fillText(cores[roleta2].nome, canvas.width*0.7, canvas.height/2);

    ctx.fillStyle = "#555";
    ctx.font = "40px Arial";
    ctx.fillText("üé° ESCOLHENDO CORES üé°", canvas.width/2, canvas.height*0.25);

    tempoRoleta--;
    if (tempoRoleta <= 0) {
      cor1 = cores[roleta1];
      cor2 = cores[roleta2];
      iniciarJogo();
    }
  }

  // ===== JOGO =====
  if (estado === "jogando") {
    tempo--;

    // TIMER GIGANTE
    const tamanhoTimer = Math.min(canvas.width, canvas.height) * 0.6;
    ctx.fillStyle = "#444";
    ctx.font = `900 ${tamanhoTimer}px Arial`;
    ctx.fillText(Math.ceil(tempo/60), canvas.width/2, canvas.height/2);

    // movimento
    let angP = Math.atan2(fugitiva.y - pegadora.y, fugitiva.x - pegadora.x);
    pegadora.vx = Math.cos(angP) * 3;
    pegadora.vy = Math.sin(angP) * 3;

    let angF = Math.atan2(fugitiva.y - pegadora.y, fugitiva.x - pegadora.x);
    fugitiva.vx = Math.cos(angF) * 2.2;
    fugitiva.vy = Math.sin(angF) * 2.2;

    [pegadora, fugitiva].forEach(b => {
      b.x += b.vx;
      b.y += b.vy;
      b.x = Math.max(RAIO, Math.min(canvas.width - RAIO, b.x));
      b.y = Math.max(RAIO, Math.min(canvas.height - RAIO, b.y));
    });

    // colis√£o
    if (Math.hypot(pegadora.x - fugitiva.x, pegadora.y - fugitiva.y) < RAIO*2) {
      criarConfetes(pegadora.cor);
      estado = "fim";
    }

    if (tempo <= 0) {
      criarConfetes(fugitiva.cor);
      estado = "fim";
    }

    // bolas por cima do timer
    [pegadora, fugitiva].forEach(b => {
      ctx.beginPath();
      ctx.arc(b.x, b.y, RAIO, 0, Math.PI*2);
      ctx.fillStyle = b.cor;
      ctx.fill();
    });
  }

  // ===== CONFETES =====
  confetes.forEach((c,i) => {
    c.x += c.dx;
    c.y += c.dy;
    c.dy += 0.25;
    c.vida--;
    ctx.fillStyle = c.cor;
    ctx.fillRect(c.x, c.y, 4, 4);
    if (c.vida <= 0) confetes.splice(i,1);
  });

  if (estado === "fim" && confetes.length === 0) {
    iniciarRoletas();
  }

  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
