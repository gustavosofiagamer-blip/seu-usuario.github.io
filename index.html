<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Pega-Pega com Roleta</title>
<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#111;
}
canvas{display:block}
</style>
</head>
<body>

<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

// ===== CONFIG =====
const RAIO = 14;
const TEMPO = 10 * 60;

const CORES = [
  {nome:"AMARELO", cor:"yellow"},
  {nome:"VERMELHO", cor:"red"},
  {nome:"AZUL", cor:"dodgerblue"},
  {nome:"VERDE", cor:"lime"}
];

// ===== ESTADO =====
let estado = "roleta";
let roletaA = null;
let roletaB = null;
let framesRoleta = 180;

let corA = null;
let corB = null;

let pegadora, fugitiva;
let tempo;
let confetes = [];

// ===== ROLETAS =====
function criarRoleta(x,y){
  return {
    x,y,
    angulo: Math.random()*Math.PI*2,
    vel: 0.35,
    ativa: true
  };
}

function desenharRoleta(r){
  const raio = 120;
  const fatia = (Math.PI*2)/CORES.length;

  for(let i=0;i<CORES.length;i++){
    ctx.beginPath();
    ctx.moveTo(r.x,r.y);
    ctx.fillStyle = CORES[i].cor;
    ctx.arc(
      r.x,r.y,raio,
      r.angulo + i*fatia,
      r.angulo + (i+1)*fatia
    );
    ctx.fill();
  }

  ctx.fillStyle="#eee";
  ctx.beginPath();
  ctx.arc(r.x,r.y,10,0,Math.PI*2);
  ctx.fill();

  ctx.fillStyle="#fff";
  ctx.beginPath();
  ctx.moveTo(r.x,r.y-raio-18);
  ctx.lineTo(r.x-12,r.y-raio);
  ctx.lineTo(r.x+12,r.y-raio);
  ctx.fill();
}

function corSelecionada(r){
  const fatia = (Math.PI*2)/CORES.length;
  let ang = (Math.PI*1.5 - r.angulo + Math.PI*2)%(Math.PI*2);
  return CORES[Math.floor(ang/fatia)];
}

// ===== JOGO =====
function criarBola(cor){
  return {
    cor,
    x: Math.random()*(canvas.width-RAIO*2)+RAIO,
    y: Math.random()*(canvas.height-RAIO*2)+RAIO,
    vx:0, vy:0
  };
}

function iniciarJogo(){
  pegadora = criarBola(corA.cor);
  fugitiva = criarBola(corB.cor);
  tempo = TEMPO;
  confetes = [];
  estado = "jogo";
}

function criarConfetes(cor){
  for(let i=0;i<120;i++){
    confetes.push({
      x:canvas.width/2,
      y:canvas.height/2,
      dx:(Math.random()-0.5)*10,
      dy:(Math.random()-0.5)*10,
      vida:90,
      cor
    });
  }
}

// ===== LOOP =====
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  // ===== ROLETAS =====
  if(estado==="roleta"){
    if(!roletaA){
      roletaA = criarRoleta(canvas.width*0.35, canvas.height/2);
      roletaB = criarRoleta(canvas.width*0.65, canvas.height/2);
      framesRoleta = 180;
      corA = corB = null;
    }

    [roletaA, roletaB].forEach(r=>{
      if(r.ativa){
        r.angulo += r.vel;
        r.vel *= 0.985;
      }
      desenharRoleta(r);
    });

    ctx.fillStyle="#aaa";
    ctx.font="36px Arial";
    ctx.textAlign="center";
    ctx.fillText("ðŸŽ¡ ESCOLHENDO CORES ðŸŽ¡", canvas.width/2, canvas.height*0.2);

    framesRoleta--;

    if(framesRoleta<=0){
      roletaA.ativa = false;
      roletaB.ativa = false;

      corA = corSelecionada(roletaA);
      corB = corSelecionada(roletaB);

      // GARANTIA DE CORES DIFERENTES
      if(corA.cor === corB.cor){
        roletaB = criarRoleta(canvas.width*0.65, canvas.height/2);
        framesRoleta = 120;
      } else {
        iniciarJogo();
      }
    }
  }

  // ===== JOGO =====
  if(estado==="jogo"){
    tempo--;

    const t = Math.min(canvas.width,canvas.height)*0.6;
    ctx.fillStyle="#444";
    ctx.font=`900 ${t}px Arial`;
    ctx.textAlign="center";
    ctx.textBaseline="middle";
    ctx.fillText(Math.ceil(tempo/60), canvas.width/2, canvas.height/2);

    let a = Math.atan2(fugitiva.y-pegadora.y, fugitiva.x-pegadora.x);
    pegadora.vx = Math.cos(a)*3;
    pegadora.vy = Math.sin(a)*3;
    fugitiva.vx = -Math.cos(a)*2.2;
    fugitiva.vy = -Math.sin(a)*2.2;

    [pegadora,fugitiva].forEach(b=>{
      b.x+=b.vx;
      b.y+=b.vy;
      b.x=Math.max(RAIO,Math.min(canvas.width-RAIO,b.x));
      b.y=Math.max(RAIO,Math.min(canvas.height-RAIO,b.y));

      ctx.beginPath();
      ctx.arc(b.x,b.y,RAIO,0,Math.PI*2);
      ctx.fillStyle=b.cor;
      ctx.fill();
    });

    if(Math.hypot(pegadora.x-fugitiva.x, pegadora.y-fugitiva.y)<RAIO*2){
      criarConfetes(pegadora.cor);
      estado="fim";
    }

    if(tempo<=0){
      criarConfetes(fugitiva.cor);
      estado="fim";
    }
  }

  // ===== CONFETES =====
  confetes.forEach((c,i)=>{
    c.x+=c.dx;
    c.y+=c.dy;
    c.dy+=0.3;
    c.vida--;
    ctx.fillStyle=c.cor;
    ctx.fillRect(c.x,c.y,4,4);
    if(c.vida<=0) confetes.splice(i,1);
  });

  if(estado==="fim" && confetes.length===0){
    roletaA = roletaB = null;
    estado="roleta";
  }

  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
