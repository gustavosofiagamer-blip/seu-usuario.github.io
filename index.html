<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Pega-Pega das Bolas</title>
<style>
html, body {
  margin: 0;
  padding: 0;
  overflow: hidden;
  background: #111;
}
canvas { display: block; }
</style>
</head>
<body>
<canvas id="c"></canvas>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
resize();
addEventListener("resize", resize);

const RAIO = 14;
const TEMPO_FUGA = 20 * 60; // 20 segundos (60fps)
const RESTART_DELAY = 5 * 60;

const cores = [
  { nome: "amarelo", cor: "yellow" },
  { nome: "vermelho", cor: "red" },
  { nome: "azul", cor: "dodgerblue" },
  { nome: "verde", cor: "lime" }
];

let bolas = [];
let pegadora = null;
let fugitiva = null;
let tempo = 0;
let estado = "jogando";
let vencedor = null;
let confetes = [];
let delay = 0;

function iniciarJogo() {
  bolas = cores.map(c => ({
    cor: c.cor,
    x: Math.random() * (canvas.width - RAIO * 2) + RAIO,
    y: Math.random() * (canvas.height - RAIO * 2) + RAIO,
    vx: 0,
    vy: 0
  }));

  let indices = [0,1,2,3].sort(() => Math.random() - 0.5);
  pegadora = bolas[indices[0]];
  fugitiva = bolas[indices[1]];

  tempo = TEMPO_FUGA;
  estado = "jogando";
  vencedor = null;
  confetes = [];
  delay = 0;
}
iniciarJogo();

function manterNaTela(b) {
  if (b.x < RAIO) b.x = RAIO;
  if (b.x > canvas.width - RAIO) b.x = canvas.width - RAIO;
  if (b.y < RAIO) b.y = RAIO;
  if (b.y > canvas.height - RAIO) b.y = canvas.height - RAIO;
}

function criarConfetes(cor) {
  for (let i = 0; i < 80; i++) {
    confetes.push({
      x: canvas.width / 2,
      y: canvas.height / 2,
      dx: (Math.random() - 0.5) * 8,
      dy: (Math.random() - 0.5) * 8,
      vida: 80,
      cor
    });
  }
}

function loop() {
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if (estado === "jogando") {
    tempo--;

    // movimento pegadora
    let angP = Math.atan2(fugitiva.y - pegadora.y, fugitiva.x - pegadora.x);
    pegadora.vx = Math.cos(angP) * 3;
    pegadora.vy = Math.sin(angP) * 3;

    // movimento fugitiva
    let angF = Math.atan2(fugitiva.y - pegadora.y, fugitiva.x - pegadora.x);
    fugitiva.vx = Math.cos(angF) * 2.2;
    fugitiva.vy = Math.sin(angF) * 2.2;

    bolas.forEach(b => {
      b.x += b.vx;
      b.y += b.vy;
      manterNaTela(b);
    });

    // colis√£o
    let d = Math.hypot(pegadora.x - fugitiva.x, pegadora.y - fugitiva.y);
    if (d < RAIO * 2) {
      vencedor = pegadora;
      criarConfetes(pegadora.cor);
      estado = "fim";
    }

    // tempo acabou
    if (tempo <= 0) {
      vencedor = fugitiva;
      criarConfetes(fugitiva.cor);
      estado = "fim";
    }
  } 
  else {
    delay++;
    if (delay >= RESTART_DELAY) iniciarJogo();
  }

  // desenhar bolas
  bolas.forEach(b => {
    ctx.beginPath();
    ctx.arc(b.x, b.y, RAIO, 0, Math.PI * 2);
    ctx.fillStyle = b.cor;
    ctx.fill();
  });

  // confetes
  confetes.forEach((c,i) => {
    c.x += c.dx;
    c.y += c.dy;
    c.dy += 0.2;
    c.vida--;
    ctx.fillStyle = c.cor;
    ctx.fillRect(c.x, c.y, 4, 4);
    if (c.vida <= 0) confetes.splice(i,1);
  });

  // HUD
  ctx.fillStyle = "white";
  ctx.font = "18px Arial";
  ctx.fillText(`Tempo: ${Math.ceil(tempo/60)}`, 20, 30);

  requestAnimationFrame(loop);
}

loop();
</script>
</body>
</html>
